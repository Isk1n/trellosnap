// Generated by CoffeeScript 1.8.0
(function() {
  var BGCapturePartial;

  BGCapturePartial = (function() {
    var edit_page_path, open_edit_tab, page_info;

    function BGCapturePartial() {}

    edit_page_path = "/views/edit.html";

    BGCapturePartial.screenshot = function(image_info) {
      return chrome.tabs.captureVisibleTab(void 0, {
        format: "png"
      }, (function(_this) {
        return function(image) {
          return open_edit_tab(image, image_info);
        };
      })(this));
    };

    page_info = function() {
      return {
        browser: "mozilla",
        resolution: "500x400"
      };
    };

    open_edit_tab = function(image, image_info) {
      return chrome.tabs.create({
        url: edit_page_path
      }, (function(_this) {
        return function(tab) {
          chrome.tabs.sendMessage(tab.id, {
            image: image,
            image_info: image_info,
            page: page_info(),
            screenshot: "partial"
          });
          return window.close();
        };
      })(this));
    };

    return BGCapturePartial;

  })();

  chrome.runtime.onMessage.addListener(function(request, sender, sendResponse) {
    if (request.capture) {
      return BGCapturePartial.screenshot(request.image_info);
    }
  });

}).call(this);
