// Generated by CoffeeScript 1.8.0
(function() {
  this.Selection = (function() {
    var $bottom_overlay, $box, $left_overlay, $right_overlay, $top_overlay, $trellosnap, disable_scroll, resize_bottom_overlay, resize_right_overlay, resize_selection_box, resize_top_overlay, selection_box_html, win_w, win_y;

    function Selection() {}

    $trellosnap = void 0;

    $box = void 0;

    $top_overlay = void 0;

    $right_overlay = void 0;

    $bottom_overlay = void 0;

    $left_overlay = void 0;

    win_w = void 0;

    win_y = void 0;

    Selection.mouse_x = function(e) {
      return e.pageX - $trellosnap.offset().left;
    };

    Selection.mouse_y = function(e) {
      return e.pageY - $trellosnap.offset().top;
    };

    Selection.start_drawing_box = function(x, y) {
      disable_scroll();
      win_w = $(window).outerWidth();
      win_y = $(window).outerHeight();
      $box.css({
        left: "" + x + "px",
        top: "" + y + "px"
      });
      $top_overlay.css({
        width: "" + x + "px",
        height: "" + y + "px"
      });
      $right_overlay.css({
        width: "" + (win_w - x) + "px",
        height: "" + y + "px"
      });
      $bottom_overlay.css({
        width: "" + (win_w - x) + "px",
        height: "" + (win_y - y) + "px"
      });
      $left_overlay.css({
        width: "" + x + "px",
        height: "" + (win_y - y) + "px"
      });
      return $(document).on("mousemove", (function(_this) {
        return function(e) {
          resize_selection_box(x, y, _this.mouse_x(e), _this.mouse_y(e));
          resize_top_overlay(x, _this.mouse_x(e));
          resize_right_overlay(x, y, _this.mouse_x(e), _this.mouse_y(e));
          return resize_bottom_overlay(y, _this.mouse_y(e));
        };
      })(this));
    };

    Selection.stop_drawing_box = function() {
      $(document).unbind("mousedown");
      $(document).unbind("mouseup");
      return $(document).unbind("mousemove");
    };

    Selection.append_selection_box = function() {
      $("body").append(selection_box_html());
      $trellosnap = $("#trellosnap");
      $box = $("#trellosnap-selection-box");
      $top_overlay = $("#trellosnap-overlay-top");
      $right_overlay = $("#trellosnap-overlay-right");
      $bottom_overlay = $("#trellosnap-overlay-bottom");
      return $left_overlay = $("#trellosnap-overlay-left");
    };

    selection_box_html = function() {
      return "<div id=\"trellosnap\">\n  <div class=\"trellosnap-overlay\" id=\"trellosnap-overlay-top\"></div>\n  <div class=\"trellosnap-overlay\" id=\"trellosnap-overlay-right\"></div>\n  <div class=\"trellosnap-overlay\" id=\"trellosnap-overlay-bottom\"></div>\n  <div class=\"trellosnap-overlay\" id=\"trellosnap-overlay-left\"></div>\n  <div id=\"trellosnap-selection-box\"></div>\n</div>";
    };

    resize_selection_box = function(old_x, old_y, new_x, new_y) {
      return $box.css({
        width: "" + (new_x >= old_x ? new_x - old_x : "0") + "px",
        height: "" + (new_y >= old_y ? new_y - old_y : "0") + "px"
      });
    };

    resize_top_overlay = function(old_x, new_x) {
      return $top_overlay.css("width", "" + (new_x >= old_x ? new_x : old_x));
    };

    resize_right_overlay = function(old_x, old_y, new_x, new_y) {
      return $right_overlay.css({
        width: "" + (new_x >= old_x ? win_w - new_x : win_w - old_x) + "px",
        height: "" + (new_y >= old_y ? new_y : old_y) + "px"
      });
    };

    resize_bottom_overlay = function(old_y, new_y) {
      return $bottom_overlay.css("height", "" + (new_y >= old_y ? win_y - new_y : win_y - old_y) + "px");
    };

    disable_scroll = function() {
      return $("html, body").addClass("trellosnap-no-scroll");
    };

    return Selection;

  })();

  jQuery(function() {
    if (!$("#trellosnap").length) {
      Selection.append_selection_box();
    }
    return $(document).on("mousedown", function(e) {
      e.preventDefault();
      return Selection.start_drawing_box(Selection.mouse_x(e), Selection.mouse_y(e));
    }).on("mouseup", function(e) {
      e.preventDefault();
      return Selection.stop_drawing_box();
    });
  });

}).call(this);
