// Generated by CoffeeScript 1.8.0
(function() {
  this.Selection = (function() {
    var disable_scroll, resize_selection_box, selection_box_html;

    function Selection() {}

    Selection.mouse_x = function($trellosnap, e) {
      return e.pageX - $trellosnap.offset().left;
    };

    Selection.mouse_y = function($trellosnap, e) {
      return e.pageY - $trellosnap.offset().top;
    };

    Selection.start_drawing_box = function(x, y, $trellosnap) {
      var $box;
      $box = $("#trellosnap-selection-box");
      disable_scroll();
      console.log("" + x + "," + y);
      $box.css({
        left: "" + x + "px",
        top: "" + y + "px"
      });
      return $(document).on("mousemove", (function(_this) {
        return function(e) {
          return resize_selection_box(x, y, _this.mouse_x($trellosnap, e), _this.mouse_y($trellosnap, e), $box);
        };
      })(this));
    };

    Selection.stop_drawing_box = function(x, y, $trellosnap) {
      console.log("" + x + "," + y);
      $(document).unbind("mousedown");
      $(document).unbind("mouseup");
      return $(document).unbind("mousemove");
    };

    Selection.append_selection_box = function() {
      return $("body").append(selection_box_html());
    };

    selection_box_html = function() {
      return "<div id=\"trellosnap\">\n  <div class=\"trellosnap-overlay\" id=\"trellosnap-overlay-top\"></div>\n  <div class=\"trellosnap-overlay\" id=\"trellosnap-overlay-right\"></div>\n  <div class=\"trellosnap-overlay\" id=\"trellosnap-overlay-bottom\"></div>\n  <div class=\"trellosnap-overlay\" id=\"trellosnap-overlay-left\"></div>\n  <div id=\"trellosnap-selection-box\"></div>\n</div>";
    };

    resize_selection_box = function(old_x, old_y, new_x, new_y, $box) {
      return $box.css({
        width: "" + (new_x >= old_x ? new_x - old_x : "0") + "px",
        height: "" + (new_y >= old_y ? new_y - old_y : "0") + "px"
      });
    };

    disable_scroll = function() {
      return $("html, body").addClass("trellosnap-no-scroll");
    };

    return Selection;

  })();

  jQuery(function() {
    var $trellosnap;
    if (!$("#trellosnap").length) {
      Selection.append_selection_box();
    }
    $trellosnap = $("#trellosnap");
    return $(document).on("mousedown", function(e) {
      e.preventDefault();
      return Selection.start_drawing_box(Selection.mouse_x($trellosnap, e), Selection.mouse_y($trellosnap, e), $trellosnap);
    }).on("mouseup", function(e) {
      e.preventDefault();
      return Selection.stop_drawing_box(Selection.mouse_x($trellosnap, e), Selection.mouse_y($trellosnap, e), $trellosnap);
    });
  });

}).call(this);
